{"version":3,"file":"module-softphone-backend.js","names":["idUrl","idForm","className","inputClassName","ModuleSoftphoneBackend","$formObj","$","$checkBoxes","$dropDowns","$disabilityFields","$statusToggle","$moduleStatus","_contactsWs","_contactsWsReconnectAttempt","_contactsWsReconnectTimer","_contactsWsTokenTimer","_contactsWsLog","_activeCallsWs","_activeCallsWsReconnectAttempt","_activeCallsWsReconnectTimer","_activeCallsWsTokenTimer","validateRules","isAccessTokenExpired","leewaySeconds","arguments","length","undefined","token","val","parts","split","payloadB64Url","payloadB64","replace","json","atob","padEnd","payload","JSON","parse","exp","Number","now","Math","floor","Date","e","scheduleContactsWsReconnect","source","forceReAuth","_this","clearTimeout","setTimeout","window","location","reload","attempt","baseDelay","maxDelay","delay","min","pow","connectContactsWs","console","log","scheduleActiveCallsWsReconnect","_this2","connectActiveCallsWs","disconnectContactsWs","close","disconnectActiveCallsWs","_this3","accessToken","readyState","WebSocket","OPEN","CONNECTING","wsProto","protocol","wsHost","host","tokenParam","encodeURIComponent","wsUrl","concat","onopen","appendContactsWsLog","String","secondsToRefresh","max","onmessage","event","raw","data","line","parsed","stringify","onerror","onclose","code","reason","authCloseCodes","Set","has","_this4","setActiveCallsWsLast","message","ts","toISOString","Array","isArray","push","slice","$ta","join","el","get","scrollTop","scrollHeight","initialize","checkbox","dropdown","initializeForm","tab","checkStatusToggle","removeClass","show","addClass","hide","cbBeforeSendForm","settings","result","form","cbAfterSendForm","Form","url","globalRootUrl","changeStatus","status","html","globalTranslate","mod_tpl_Connected","mod_tpl_Disconnected","mod_tpl_UpdateStatus","document","ready"],"sources":["src/module-softphone-backend.js"],"sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\nconst idUrl    \t\t= 'module-softphone-backend';\nconst idForm    \t\t= 'module-softphone-backend-form';\nconst className \t\t= 'ModuleSoftphoneBackend';\nconst inputClassName = 'mikopbx-module-input';\n\n/* global globalRootUrl, globalTranslate, Form, Config */\nconst ModuleSoftphoneBackend = {\n\t$formObj: $('#'+idForm),\n\t$checkBoxes: $('#'+idForm+' .ui.checkbox'),\n\t$dropDowns: $('#'+idForm+' .ui.dropdown'),\n\t$disabilityFields: $('#'+idForm+'  .disability'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$moduleStatus: $('#status'),\n\t// WebSocket: contacts channel (Nchan subscriber)\n\t_contactsWs: null,\n\t_contactsWsReconnectAttempt: 0,\n\t_contactsWsReconnectTimer: null,\n\t_contactsWsTokenTimer: null,\n\t_contactsWsLog: [],\n\t// WebSocket: active-calls channel (Nchan subscriber)\n\t_activeCallsWs: null,\n\t_activeCallsWsReconnectAttempt: 0,\n\t_activeCallsWsReconnectTimer: null,\n\t_activeCallsWsTokenTimer: null,\n\t/**\n\t * Field validation rules\n\t * https://semantic-ui.com/behaviors/form.html\n\t */\n\tvalidateRules: {\n\n\t},\n\t/**\n\t * Check JWT access token expiry (best-effort).\n\t * @param {number} leewaySeconds\n\t * @returns {boolean}\n\t */\n\tisAccessTokenExpired(leewaySeconds = 0) {\n\t\ttry {\n\t\t\tconst token = $('#access_token').val();\n\t\t\tif (!token || typeof token !== 'string') return true;\n\t\t\tconst parts = token.split('.');\n\t\t\tif (parts.length < 2) return true;\n\t\t\tconst payloadB64Url = parts[1];\n\t\t\tconst payloadB64 = payloadB64Url.replace(/-/g, '+').replace(/_/g, '/');\n\t\t\tconst json = atob(payloadB64.padEnd(payloadB64.length + (4 - (payloadB64.length % 4)) % 4, '='));\n\t\t\tconst payload = JSON.parse(json);\n\t\t\tconst exp = Number(payload?.exp || 0);\n\t\t\tif (!exp) return false; // token without exp: treat as non-expiring\n\t\t\tconst now = Math.floor(Date.now() / 1000);\n\t\t\treturn now + Number(leewaySeconds || 0) >= exp;\n\t\t} catch (e) {\n\t\t\treturn true;\n\t\t}\n\t},\n\t/**\n\t * Schedule reconnect with exponential backoff.\n\t * @param {string} source\n\t * @param {boolean} forceReAuth\n\t * @returns {void}\n\t */\n\tscheduleContactsWsReconnect(source, forceReAuth) {\n\t\ttry {\n\t\t\tif (this._contactsWsReconnectTimer) {\n\t\t\t\tclearTimeout(this._contactsWsReconnectTimer);\n\t\t\t\tthis._contactsWsReconnectTimer = null;\n\t\t\t}\n\n\t\t\t// If token is expired/invalid, the only safe action is to retry later.\n\t\t\t// The admin UI can refresh token by reloading page (server-side render).\n\t\t\tif (forceReAuth) {\n\t\t\t\tthis._contactsWsReconnectTimer = setTimeout(() => {\n\t\t\t\t\ttry { window.location.reload(); } catch (e) { /* ignore */ }\n\t\t\t\t}, 1000);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst attempt = Number(this._contactsWsReconnectAttempt || 0);\n\t\t\tconst baseDelay = 500; // ms\n\t\t\tconst maxDelay = 30000; // ms\n\t\t\tconst delay = Math.min(maxDelay, baseDelay * Math.pow(2, attempt));\n\t\t\tthis._contactsWsReconnectAttempt = attempt + 1;\n\n\t\t\tthis._contactsWsReconnectTimer = setTimeout(() => {\n\t\t\t\tthis.connectContactsWs();\n\t\t\t}, delay);\n\n\t\t\tconsole.log('contacts ws reconnect scheduled', { source, attempt: this._contactsWsReconnectAttempt, delay });\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * Schedule reconnect for active-calls with exponential backoff.\n\t * @param {string} source\n\t * @param {boolean} forceReAuth\n\t * @returns {void}\n\t */\n\tscheduleActiveCallsWsReconnect(source, forceReAuth) {\n\t\ttry {\n\t\t\tif (this._activeCallsWsReconnectTimer) {\n\t\t\t\tclearTimeout(this._activeCallsWsReconnectTimer);\n\t\t\t\tthis._activeCallsWsReconnectTimer = null;\n\t\t\t}\n\n\t\t\tif (forceReAuth) {\n\t\t\t\tthis._activeCallsWsReconnectTimer = setTimeout(() => {\n\t\t\t\t\ttry { window.location.reload(); } catch (e) { /* ignore */ }\n\t\t\t\t}, 1000);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst attempt = Number(this._activeCallsWsReconnectAttempt || 0);\n\t\t\tconst baseDelay = 500;\n\t\t\tconst maxDelay = 30000;\n\t\t\tconst delay = Math.min(maxDelay, baseDelay * Math.pow(2, attempt));\n\t\t\tthis._activeCallsWsReconnectAttempt = attempt + 1;\n\n\t\t\tthis._activeCallsWsReconnectTimer = setTimeout(() => {\n\t\t\t\tthis.connectActiveCallsWs();\n\t\t\t}, delay);\n\n\t\t\tconsole.log('active-calls ws reconnect scheduled', { source, attempt: this._activeCallsWsReconnectAttempt, delay });\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * Close contacts WS and clear timers.\n\t * @returns {void}\n\t */\n\tdisconnectContactsWs() {\n\t\ttry {\n\t\t\tif (this._contactsWsTokenTimer) {\n\t\t\t\tclearTimeout(this._contactsWsTokenTimer);\n\t\t\t\tthis._contactsWsTokenTimer = null;\n\t\t\t}\n\t\t\tif (this._contactsWsReconnectTimer) {\n\t\t\t\tclearTimeout(this._contactsWsReconnectTimer);\n\t\t\t\tthis._contactsWsReconnectTimer = null;\n\t\t\t}\n\t\t\tif (this._contactsWs) {\n\t\t\t\ttry { this._contactsWs.close(1000, 'client_close'); } catch (e) { /* ignore */ }\n\t\t\t}\n\t\t\tthis._contactsWs = null;\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * Close active-calls WS and clear timers.\n\t * @returns {void}\n\t */\n\tdisconnectActiveCallsWs() {\n\t\ttry {\n\t\t\tif (this._activeCallsWsTokenTimer) {\n\t\t\t\tclearTimeout(this._activeCallsWsTokenTimer);\n\t\t\t\tthis._activeCallsWsTokenTimer = null;\n\t\t\t}\n\t\t\tif (this._activeCallsWsReconnectTimer) {\n\t\t\t\tclearTimeout(this._activeCallsWsReconnectTimer);\n\t\t\t\tthis._activeCallsWsReconnectTimer = null;\n\t\t\t}\n\t\t\tif (this._activeCallsWs) {\n\t\t\t\ttry { this._activeCallsWs.close(1000, 'client_close'); } catch (e) { /* ignore */ }\n\t\t\t}\n\t\t\tthis._activeCallsWs = null;\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * Connect WebSocket to contacts subscriber endpoint.\n\t * Token is taken from $('#access_token').val().\n\t * @returns {void}\n\t */\n\tconnectContactsWs() {\n\t\ttry {\n\t\t\tconst accessToken = $('#access_token').val();\n\t\t\tif (!accessToken) return;\n\n\t\t\t// Avoid reconnecting if already connected/connecting\n\t\t\tif (this._contactsWs && (this._contactsWs.readyState === WebSocket.OPEN || this._contactsWs.readyState === WebSocket.CONNECTING)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Reset backoff on explicit connect attempt\n\t\t\tthis._contactsWsReconnectAttempt = 0;\n\n\t\t\tconst wsProto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n\t\t\tconst wsHost = window.location.host; // host:port of current page\n\t\t\tconst tokenParam = encodeURIComponent(accessToken);\n\t\t\tconst wsUrl = `${wsProto}://${wsHost}/pbxcore/api/module-softphone-backend/v1/sub/contacts?authorization=${tokenParam}`;\n\n\t\t\tthis._contactsWs = new WebSocket(wsUrl);\n\t\t\tthis._contactsWs.onopen = () => {\n\t\t\t\tconsole.log('contacts ws connected');\n\t\t\t\tthis.appendContactsWsLog('connected');\n\n\t\t\t\t// Reconnect shortly before token expires (best-effort).\n\t\t\t\ttry {\n\t\t\t\t\tconst parts = String(accessToken).split('.');\n\t\t\t\t\tif (parts.length >= 2) {\n\t\t\t\t\t\tconst payloadB64 = parts[1].replace(/-/g, '+').replace(/_/g, '/');\n\t\t\t\t\t\tconst json = atob(payloadB64.padEnd(payloadB64.length + (4 - (payloadB64.length % 4)) % 4, '='));\n\t\t\t\t\t\tconst payload = JSON.parse(json);\n\t\t\t\t\t\tconst exp = Number(payload?.exp || 0);\n\t\t\t\t\t\tif (exp) {\n\t\t\t\t\t\t\tconst now = Math.floor(Date.now() / 1000);\n\t\t\t\t\t\t\tconst secondsToRefresh = Math.max(5, exp - now - 30);\n\t\t\t\t\t\t\tif (this._contactsWsTokenTimer) clearTimeout(this._contactsWsTokenTimer);\n\t\t\t\t\t\t\tthis._contactsWsTokenTimer = setTimeout(() => {\n\t\t\t\t\t\t\t\tthis.scheduleContactsWsReconnect('token_expiring', true);\n\t\t\t\t\t\t\t}, secondsToRefresh * 1000);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._contactsWs.onmessage = (event) => {\n\t\t\t\tconst raw = event?.data;\n\t\t\t\tconsole.log(raw);\n\t\t\t\tlet line = '';\n\t\t\t\ttry {\n\t\t\t\t\tconst parsed = JSON.parse(String(raw));\n\t\t\t\t\tline = JSON.stringify(parsed);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tline = String(raw ?? '');\n\t\t\t\t}\n\t\t\t\tthis.appendContactsWsLog(line);\n\t\t\t};\n\t\t\tthis._contactsWs.onerror = (event) => {\n\t\t\t\tconsole.log('contacts ws error', event);\n\t\t\t\tthis.appendContactsWsLog('error');\n\t\t\t};\n\t\t\tthis._contactsWs.onclose = (event) => {\n\t\t\t\tconst code = event?.code;\n\t\t\t\tconst reason = event?.reason;\n\t\t\t\tconsole.log('contacts ws closed', { code, reason });\n\t\t\t\tthis.appendContactsWsLog(`closed code=${code ?? ''} reason=${reason ?? ''}`);\n\n\t\t\t\tif (this._contactsWsTokenTimer) {\n\t\t\t\t\tclearTimeout(this._contactsWsTokenTimer);\n\t\t\t\t\tthis._contactsWsTokenTimer = null;\n\t\t\t\t}\n\n\t\t\t\t// 1000 = normal close -> reconnect; auth closes vary by server implementation.\n\t\t\t\tconst authCloseCodes = new Set([1008, 4001, 4401, 4403]);\n\t\t\t\tconst forceReAuth = authCloseCodes.has(code) || this.isAccessTokenExpired(0);\n\t\t\t\tthis.scheduleContactsWsReconnect('close', forceReAuth);\n\t\t\t};\n\t\t} catch (e) {\n\t\t\tconsole.log('contacts ws init error', e);\n\t\t\tthis.appendContactsWsLog('init_error');\n\t\t\tthis.scheduleContactsWsReconnect('init_error', this.isAccessTokenExpired(0));\n\t\t}\n\t},\n\t/**\n\t * Connect WebSocket to active-calls subscriber endpoint.\n\t * Token is taken from $('#access_token').val().\n\t * Writes ONLY last message to #active_calls_ws_last.\n\t * @returns {void}\n\t */\n\tconnectActiveCallsWs() {\n\t\ttry {\n\t\t\tconst accessToken = $('#access_token').val();\n\t\t\tif (!accessToken) return;\n\n\t\t\tif (this._activeCallsWs && (this._activeCallsWs.readyState === WebSocket.OPEN || this._activeCallsWs.readyState === WebSocket.CONNECTING)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._activeCallsWsReconnectAttempt = 0;\n\n\t\t\tconst wsProto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n\t\t\tconst wsHost = window.location.host;\n\t\t\tconst tokenParam = encodeURIComponent(accessToken);\n\t\t\tconst wsUrl = `${wsProto}://${wsHost}/pbxcore/api/module-softphone-backend/v1/sub/active-calls?authorization=${tokenParam}`;\n\n\t\t\tthis._activeCallsWs = new WebSocket(wsUrl);\n\t\t\tthis._activeCallsWs.onopen = () => {\n\t\t\t\tconsole.log('active-calls ws connected');\n\t\t\t\tthis.setActiveCallsWsLast('connected');\n\n\t\t\t\t// Reconnect shortly before token expires (best-effort).\n\t\t\t\ttry {\n\t\t\t\t\tconst parts = String(accessToken).split('.');\n\t\t\t\t\tif (parts.length >= 2) {\n\t\t\t\t\t\tconst payloadB64 = parts[1].replace(/-/g, '+').replace(/_/g, '/');\n\t\t\t\t\t\tconst json = atob(payloadB64.padEnd(payloadB64.length + (4 - (payloadB64.length % 4)) % 4, '='));\n\t\t\t\t\t\tconst payload = JSON.parse(json);\n\t\t\t\t\t\tconst exp = Number(payload?.exp || 0);\n\t\t\t\t\t\tif (exp) {\n\t\t\t\t\t\t\tconst now = Math.floor(Date.now() / 1000);\n\t\t\t\t\t\t\tconst secondsToRefresh = Math.max(5, exp - now - 30);\n\t\t\t\t\t\t\tif (this._activeCallsWsTokenTimer) clearTimeout(this._activeCallsWsTokenTimer);\n\t\t\t\t\t\t\tthis._activeCallsWsTokenTimer = setTimeout(() => {\n\t\t\t\t\t\t\t\tthis.scheduleActiveCallsWsReconnect('token_expiring', true);\n\t\t\t\t\t\t\t}, secondsToRefresh * 1000);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._activeCallsWs.onmessage = (event) => {\n\t\t\t\tconst raw = event?.data;\n\t\t\t\tconsole.log(raw);\n\t\t\t\tlet line = '';\n\t\t\t\ttry {\n\t\t\t\t\tconst parsed = JSON.parse(String(raw));\n\t\t\t\t\tline = JSON.stringify(parsed);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tline = String(raw ?? '');\n\t\t\t\t}\n\t\t\t\tthis.setActiveCallsWsLast(line);\n\t\t\t};\n\t\t\tthis._activeCallsWs.onerror = (event) => {\n\t\t\t\tconsole.log('active-calls ws error', event);\n\t\t\t\tthis.setActiveCallsWsLast('error');\n\t\t\t};\n\t\t\tthis._activeCallsWs.onclose = (event) => {\n\t\t\t\tconst code = event?.code;\n\t\t\t\tconst reason = event?.reason;\n\t\t\t\tconsole.log('active-calls ws closed', { code, reason });\n\t\t\t\tthis.setActiveCallsWsLast(`closed code=${code ?? ''} reason=${reason ?? ''}`);\n\n\t\t\t\tif (this._activeCallsWsTokenTimer) {\n\t\t\t\t\tclearTimeout(this._activeCallsWsTokenTimer);\n\t\t\t\t\tthis._activeCallsWsTokenTimer = null;\n\t\t\t\t}\n\n\t\t\t\tconst authCloseCodes = new Set([1008, 4001, 4401, 4403]);\n\t\t\t\tconst forceReAuth = authCloseCodes.has(code) || this.isAccessTokenExpired(0);\n\t\t\t\tthis.scheduleActiveCallsWsReconnect('close', forceReAuth);\n\t\t\t};\n\t\t} catch (e) {\n\t\t\tconsole.log('active-calls ws init error', e);\n\t\t\tthis.setActiveCallsWsLast('init_error');\n\t\t\tthis.scheduleActiveCallsWsReconnect('init_error', this.isAccessTokenExpired(0));\n\t\t}\n\t},\n\t/**\n\t * Append a line to contacts WS log textarea (keep last 20).\n\t * @param {string} message\n\t * @returns {void}\n\t */\n\tappendContactsWsLog(message) {\n\t\ttry {\n\t\t\tconst ts = new Date().toISOString();\n\t\t\tconst line = `[${ts}] ${String(message ?? '')}`;\n\t\t\tif (!Array.isArray(this._contactsWsLog)) this._contactsWsLog = [];\n\t\t\tthis._contactsWsLog.push(line);\n\t\t\tif (this._contactsWsLog.length > 20) {\n\t\t\t\tthis._contactsWsLog = this._contactsWsLog.slice(-20);\n\t\t\t}\n\t\t\tconst $ta = $('#contacts_ws_log');\n\t\t\tif ($ta && $ta.length) {\n\t\t\t\t$ta.val(this._contactsWsLog.join('\\n'));\n\t\t\t\t// Autoscroll to bottom\n\t\t\t\tconst el = $ta.get(0);\n\t\t\t\tif (el) el.scrollTop = el.scrollHeight;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * Set last active-calls WS message in textarea.\n\t * @param {string} message\n\t * @returns {void}\n\t */\n\tsetActiveCallsWsLast(message) {\n\t\ttry {\n\t\t\tconst line = String(message ?? '');\n\t\t\tconst $ta = $('#active_calls_ws_last');\n\t\t\tif ($ta && $ta.length) {\n\t\t\t\t$ta.val(line);\n\t\t\t\tconst el = $ta.get(0);\n\t\t\t\tif (el) el.scrollTop = el.scrollHeight;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t},\n\t/**\n\t * On page load we init some Semantic UI library\n\t */\n\tinitialize() {\n\t\t// инициализируем чекбоксы и выподающие менюшки\n\t\twindow[className].$checkBoxes.checkbox();\n\t\twindow[className].$dropDowns.dropdown();\n\t\twindow[className].initializeForm();\n\t\t$('.menu .item').tab();\n\t\t// Try connect WS if token is already present in DOM\n\t\twindow[className].connectContactsWs();\n\t\twindow[className].connectActiveCallsWs();\n\t},\n\n\t/**\n\t * Change some form elements classes depends of module status\n\t */\n\tcheckStatusToggle() {\n\t\tif (window[className].$statusToggle.checkbox('is checked')) {\n\t\t\twindow[className].$disabilityFields.removeClass('disabled');\n\t\t\twindow[className].$moduleStatus.show();\n\t\t} else {\n\t\t\twindow[className].$disabilityFields.addClass('disabled');\n\t\t\twindow[className].$moduleStatus.hide();\n\t\t}\n\t},\n\t/**\n\t * We can modify some data before form send\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = window[className].$formObj.form('get values');\n\t\treturn result;\n\t},\n\t/**\n\t * Some actions after forms send\n\t */\n\tcbAfterSendForm() {\n\t},\n\t/**\n\t * Initialize form parameters\n\t */\n\tinitializeForm() {\n\t\tForm.$formObj = window[className].$formObj;\n\t\tForm.url = `${globalRootUrl}${idUrl}/save`;\n\t\tForm.validateRules = window[className].validateRules;\n\t\tForm.cbBeforeSendForm = window[className].cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = window[className].cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n\t/**\n\t * Update the module state on form label\n\t * @param status\n\t */\n\tchangeStatus(status) {\n\t\tswitch (status) {\n\t\t\tcase 'Connected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('grey')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('green');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Connected);\n\t\t\t\tbreak;\n\t\t\tcase 'Disconnected':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Disconnected);\n\t\t\t\tbreak;\n\t\t\tcase 'Updating':\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(`<i class=\"spinner loading icon\"></i>${globalTranslate.mod_tpl_UpdateStatus}`);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\twindow[className].$moduleStatus\n\t\t\t\t\t.removeClass('green')\n\t\t\t\t\t.removeClass('red')\n\t\t\t\t\t.addClass('grey');\n\t\t\t\twindow[className].$moduleStatus.html(globalTranslate.mod_tpl_Disconnected);\n\t\t\t\tbreak;\n\t\t}\n\t},\n};\n\n$(document).ready(() => {\n\t// Ensure module is available via window[className]\n\twindow[className] = ModuleSoftphoneBackend;\n\twindow[className].initialize();\n});\n\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAMA,KAAK,GAAQ,0BAA0B;AAC7C,IAAMC,MAAM,GAAQ,+BAA+B;AACnD,IAAMC,SAAS,GAAK,wBAAwB;AAC5C,IAAMC,cAAc,GAAG,sBAAsB;;AAE7C;AACA,IAAMC,sBAAsB,GAAG;EAC9BC,QAAQ,EAAEC,CAAC,CAAC,GAAG,GAACL,MAAM,CAAC;EACvBM,WAAW,EAAED,CAAC,CAAC,GAAG,GAACL,MAAM,GAAC,eAAe,CAAC;EAC1CO,UAAU,EAAEF,CAAC,CAAC,GAAG,GAACL,MAAM,GAAC,eAAe,CAAC;EACzCQ,iBAAiB,EAAEH,CAAC,CAAC,GAAG,GAACL,MAAM,GAAC,eAAe,CAAC;EAChDS,aAAa,EAAEJ,CAAC,CAAC,uBAAuB,CAAC;EACzCK,aAAa,EAAEL,CAAC,CAAC,SAAS,CAAC;EAC3B;EACAM,WAAW,EAAE,IAAI;EACjBC,2BAA2B,EAAE,CAAC;EAC9BC,yBAAyB,EAAE,IAAI;EAC/BC,qBAAqB,EAAE,IAAI;EAC3BC,cAAc,EAAE,EAAE;EAClB;EACAC,cAAc,EAAE,IAAI;EACpBC,8BAA8B,EAAE,CAAC;EACjCC,4BAA4B,EAAE,IAAI;EAClCC,wBAAwB,EAAE,IAAI;EAC9B;AACD;AACA;AACA;EACCC,aAAa,EAAE,CAEf,CAAC;EACD;AACD;AACA;AACA;AACA;EACCC,oBAAoB,WAApBA,oBAAoBA,CAAA,EAAoB;IAAA,IAAnBC,aAAa,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC;IACrC,IAAI;MACH,IAAMG,KAAK,GAAGrB,CAAC,CAAC,eAAe,CAAC,CAACsB,GAAG,CAAC,CAAC;MACtC,IAAI,CAACD,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE,OAAO,IAAI;MACpD,IAAME,KAAK,GAAGF,KAAK,CAACG,KAAK,CAAC,GAAG,CAAC;MAC9B,IAAID,KAAK,CAACJ,MAAM,GAAG,CAAC,EAAE,OAAO,IAAI;MACjC,IAAMM,aAAa,GAAGF,KAAK,CAAC,CAAC,CAAC;MAC9B,IAAMG,UAAU,GAAGD,aAAa,CAACE,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;MACtE,IAAMC,IAAI,GAAGC,IAAI,CAACH,UAAU,CAACI,MAAM,CAACJ,UAAU,CAACP,MAAM,GAAG,CAAC,CAAC,GAAIO,UAAU,CAACP,MAAM,GAAG,CAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;MAChG,IAAMY,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;MAChC,IAAMM,GAAG,GAAGC,MAAM,CAAC,CAAAJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,GAAG,KAAI,CAAC,CAAC;MACrC,IAAI,CAACA,GAAG,EAAE,OAAO,KAAK,CAAC,CAAC;MACxB,IAAME,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACH,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;MACzC,OAAOA,GAAG,GAAGD,MAAM,CAAClB,aAAa,IAAI,CAAC,CAAC,IAAIiB,GAAG;IAC/C,CAAC,CAAC,OAAOM,CAAC,EAAE;MACX,OAAO,IAAI;IACZ;EACD,CAAC;EACD;AACD;AACA;AACA;AACA;AACA;EACCC,2BAA2B,WAA3BA,2BAA2BA,CAACC,MAAM,EAAEC,WAAW,EAAE;IAAA,IAAAC,KAAA;IAChD,IAAI;MACH,IAAI,IAAI,CAACpC,yBAAyB,EAAE;QACnCqC,YAAY,CAAC,IAAI,CAACrC,yBAAyB,CAAC;QAC5C,IAAI,CAACA,yBAAyB,GAAG,IAAI;MACtC;;MAEA;MACA;MACA,IAAImC,WAAW,EAAE;QAChB,IAAI,CAACnC,yBAAyB,GAAGsC,UAAU,CAAC,YAAM;UACjD,IAAI;YAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;UAAE,CAAC,CAAC,OAAOT,CAAC,EAAE,CAAE;QAC/C,CAAC,EAAE,IAAI,CAAC;QACR;MACD;MAEA,IAAMU,OAAO,GAAGf,MAAM,CAAC,IAAI,CAAC5B,2BAA2B,IAAI,CAAC,CAAC;MAC7D,IAAM4C,SAAS,GAAG,GAAG,CAAC,CAAC;MACvB,IAAMC,QAAQ,GAAG,KAAK,CAAC,CAAC;MACxB,IAAMC,KAAK,GAAGhB,IAAI,CAACiB,GAAG,CAACF,QAAQ,EAAED,SAAS,GAAGd,IAAI,CAACkB,GAAG,CAAC,CAAC,EAAEL,OAAO,CAAC,CAAC;MAClE,IAAI,CAAC3C,2BAA2B,GAAG2C,OAAO,GAAG,CAAC;MAE9C,IAAI,CAAC1C,yBAAyB,GAAGsC,UAAU,CAAC,YAAM;QACjDF,KAAI,CAACY,iBAAiB,CAAC,CAAC;MACzB,CAAC,EAAEH,KAAK,CAAC;MAETI,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAE;QAAEhB,MAAM,EAANA,MAAM;QAAEQ,OAAO,EAAE,IAAI,CAAC3C,2BAA2B;QAAE8C,KAAK,EAALA;MAAM,CAAC,CAAC;IAC7G,CAAC,CAAC,OAAOb,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;AACA;AACA;AACA;EACCmB,8BAA8B,WAA9BA,8BAA8BA,CAACjB,MAAM,EAAEC,WAAW,EAAE;IAAA,IAAAiB,MAAA;IACnD,IAAI;MACH,IAAI,IAAI,CAAC/C,4BAA4B,EAAE;QACtCgC,YAAY,CAAC,IAAI,CAAChC,4BAA4B,CAAC;QAC/C,IAAI,CAACA,4BAA4B,GAAG,IAAI;MACzC;MAEA,IAAI8B,WAAW,EAAE;QAChB,IAAI,CAAC9B,4BAA4B,GAAGiC,UAAU,CAAC,YAAM;UACpD,IAAI;YAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;UAAE,CAAC,CAAC,OAAOT,CAAC,EAAE,CAAE;QAC/C,CAAC,EAAE,IAAI,CAAC;QACR;MACD;MAEA,IAAMU,OAAO,GAAGf,MAAM,CAAC,IAAI,CAACvB,8BAA8B,IAAI,CAAC,CAAC;MAChE,IAAMuC,SAAS,GAAG,GAAG;MACrB,IAAMC,QAAQ,GAAG,KAAK;MACtB,IAAMC,KAAK,GAAGhB,IAAI,CAACiB,GAAG,CAACF,QAAQ,EAAED,SAAS,GAAGd,IAAI,CAACkB,GAAG,CAAC,CAAC,EAAEL,OAAO,CAAC,CAAC;MAClE,IAAI,CAACtC,8BAA8B,GAAGsC,OAAO,GAAG,CAAC;MAEjD,IAAI,CAACrC,4BAA4B,GAAGiC,UAAU,CAAC,YAAM;QACpDc,MAAI,CAACC,oBAAoB,CAAC,CAAC;MAC5B,CAAC,EAAER,KAAK,CAAC;MAETI,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAE;QAAEhB,MAAM,EAANA,MAAM;QAAEQ,OAAO,EAAE,IAAI,CAACtC,8BAA8B;QAAEyC,KAAK,EAALA;MAAM,CAAC,CAAC;IACpH,CAAC,CAAC,OAAOb,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;AACA;EACCsB,oBAAoB,WAApBA,oBAAoBA,CAAA,EAAG;IACtB,IAAI;MACH,IAAI,IAAI,CAACrD,qBAAqB,EAAE;QAC/BoC,YAAY,CAAC,IAAI,CAACpC,qBAAqB,CAAC;QACxC,IAAI,CAACA,qBAAqB,GAAG,IAAI;MAClC;MACA,IAAI,IAAI,CAACD,yBAAyB,EAAE;QACnCqC,YAAY,CAAC,IAAI,CAACrC,yBAAyB,CAAC;QAC5C,IAAI,CAACA,yBAAyB,GAAG,IAAI;MACtC;MACA,IAAI,IAAI,CAACF,WAAW,EAAE;QACrB,IAAI;UAAE,IAAI,CAACA,WAAW,CAACyD,KAAK,CAAC,IAAI,EAAE,cAAc,CAAC;QAAE,CAAC,CAAC,OAAOvB,CAAC,EAAE,CAAE;MACnE;MACA,IAAI,CAAClC,WAAW,GAAG,IAAI;IACxB,CAAC,CAAC,OAAOkC,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;AACA;EACCwB,uBAAuB,WAAvBA,uBAAuBA,CAAA,EAAG;IACzB,IAAI;MACH,IAAI,IAAI,CAAClD,wBAAwB,EAAE;QAClC+B,YAAY,CAAC,IAAI,CAAC/B,wBAAwB,CAAC;QAC3C,IAAI,CAACA,wBAAwB,GAAG,IAAI;MACrC;MACA,IAAI,IAAI,CAACD,4BAA4B,EAAE;QACtCgC,YAAY,CAAC,IAAI,CAAChC,4BAA4B,CAAC;QAC/C,IAAI,CAACA,4BAA4B,GAAG,IAAI;MACzC;MACA,IAAI,IAAI,CAACF,cAAc,EAAE;QACxB,IAAI;UAAE,IAAI,CAACA,cAAc,CAACoD,KAAK,CAAC,IAAI,EAAE,cAAc,CAAC;QAAE,CAAC,CAAC,OAAOvB,CAAC,EAAE,CAAE;MACtE;MACA,IAAI,CAAC7B,cAAc,GAAG,IAAI;IAC3B,CAAC,CAAC,OAAO6B,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;AACA;AACA;EACCgB,iBAAiB,WAAjBA,iBAAiBA,CAAA,EAAG;IAAA,IAAAS,MAAA;IACnB,IAAI;MACH,IAAMC,WAAW,GAAGlE,CAAC,CAAC,eAAe,CAAC,CAACsB,GAAG,CAAC,CAAC;MAC5C,IAAI,CAAC4C,WAAW,EAAE;;MAElB;MACA,IAAI,IAAI,CAAC5D,WAAW,KAAK,IAAI,CAACA,WAAW,CAAC6D,UAAU,KAAKC,SAAS,CAACC,IAAI,IAAI,IAAI,CAAC/D,WAAW,CAAC6D,UAAU,KAAKC,SAAS,CAACE,UAAU,CAAC,EAAE;QACjI;MACD;MACA;MACA,IAAI,CAAC/D,2BAA2B,GAAG,CAAC;MAEpC,IAAMgE,OAAO,GAAGxB,MAAM,CAACC,QAAQ,CAACwB,QAAQ,KAAK,QAAQ,GAAG,KAAK,GAAG,IAAI;MACpE,IAAMC,MAAM,GAAG1B,MAAM,CAACC,QAAQ,CAAC0B,IAAI,CAAC,CAAC;MACrC,IAAMC,UAAU,GAAGC,kBAAkB,CAACV,WAAW,CAAC;MAClD,IAAMW,KAAK,MAAAC,MAAA,CAAMP,OAAO,SAAAO,MAAA,CAAML,MAAM,0EAAAK,MAAA,CAAuEH,UAAU,CAAE;MAEvH,IAAI,CAACrE,WAAW,GAAG,IAAI8D,SAAS,CAACS,KAAK,CAAC;MACvC,IAAI,CAACvE,WAAW,CAACyE,MAAM,GAAG,YAAM;QAC/BtB,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;QACpCO,MAAI,CAACe,mBAAmB,CAAC,WAAW,CAAC;;QAErC;QACA,IAAI;UACH,IAAMzD,KAAK,GAAG0D,MAAM,CAACf,WAAW,CAAC,CAAC1C,KAAK,CAAC,GAAG,CAAC;UAC5C,IAAID,KAAK,CAACJ,MAAM,IAAI,CAAC,EAAE;YACtB,IAAMO,UAAU,GAAGH,KAAK,CAAC,CAAC,CAAC,CAACI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;YACjE,IAAMC,IAAI,GAAGC,IAAI,CAACH,UAAU,CAACI,MAAM,CAACJ,UAAU,CAACP,MAAM,GAAG,CAAC,CAAC,GAAIO,UAAU,CAACP,MAAM,GAAG,CAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;YAChG,IAAMY,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;YAChC,IAAMM,GAAG,GAAGC,MAAM,CAAC,CAAAJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,GAAG,KAAI,CAAC,CAAC;YACrC,IAAIA,GAAG,EAAE;cACR,IAAME,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACH,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;cACzC,IAAM8C,gBAAgB,GAAG7C,IAAI,CAAC8C,GAAG,CAAC,CAAC,EAAEjD,GAAG,GAAGE,GAAG,GAAG,EAAE,CAAC;cACpD,IAAI6B,MAAI,CAACxD,qBAAqB,EAAEoC,YAAY,CAACoB,MAAI,CAACxD,qBAAqB,CAAC;cACxEwD,MAAI,CAACxD,qBAAqB,GAAGqC,UAAU,CAAC,YAAM;gBAC7CmB,MAAI,CAACxB,2BAA2B,CAAC,gBAAgB,EAAE,IAAI,CAAC;cACzD,CAAC,EAAEyC,gBAAgB,GAAG,IAAI,CAAC;YAC5B;UACD;QACD,CAAC,CAAC,OAAO1C,CAAC,EAAE;UACX;QAAA;MAEF,CAAC;MACD,IAAI,CAAClC,WAAW,CAAC8E,SAAS,GAAG,UAACC,KAAK,EAAK;QACvC,IAAMC,GAAG,GAAGD,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEE,IAAI;QACvB9B,OAAO,CAACC,GAAG,CAAC4B,GAAG,CAAC;QAChB,IAAIE,IAAI,GAAG,EAAE;QACb,IAAI;UACH,IAAMC,MAAM,GAAGzD,IAAI,CAACC,KAAK,CAACgD,MAAM,CAACK,GAAG,CAAC,CAAC;UACtCE,IAAI,GAAGxD,IAAI,CAAC0D,SAAS,CAACD,MAAM,CAAC;QAC9B,CAAC,CAAC,OAAOjD,CAAC,EAAE;UACXgD,IAAI,GAAGP,MAAM,CAACK,GAAG,aAAHA,GAAG,cAAHA,GAAG,GAAI,EAAE,CAAC;QACzB;QACArB,MAAI,CAACe,mBAAmB,CAACQ,IAAI,CAAC;MAC/B,CAAC;MACD,IAAI,CAAClF,WAAW,CAACqF,OAAO,GAAG,UAACN,KAAK,EAAK;QACrC5B,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAE2B,KAAK,CAAC;QACvCpB,MAAI,CAACe,mBAAmB,CAAC,OAAO,CAAC;MAClC,CAAC;MACD,IAAI,CAAC1E,WAAW,CAACsF,OAAO,GAAG,UAACP,KAAK,EAAK;QACrC,IAAMQ,IAAI,GAAGR,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEQ,IAAI;QACxB,IAAMC,MAAM,GAAGT,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAES,MAAM;QAC5BrC,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAE;UAAEmC,IAAI,EAAJA,IAAI;UAAEC,MAAM,EAANA;QAAO,CAAC,CAAC;QACnD7B,MAAI,CAACe,mBAAmB,gBAAAF,MAAA,CAAgBe,IAAI,aAAJA,IAAI,cAAJA,IAAI,GAAI,EAAE,cAAAf,MAAA,CAAWgB,MAAM,aAANA,MAAM,cAANA,MAAM,GAAI,EAAE,CAAE,CAAC;QAE5E,IAAI7B,MAAI,CAACxD,qBAAqB,EAAE;UAC/BoC,YAAY,CAACoB,MAAI,CAACxD,qBAAqB,CAAC;UACxCwD,MAAI,CAACxD,qBAAqB,GAAG,IAAI;QAClC;;QAEA;QACA,IAAMsF,cAAc,GAAG,IAAIC,GAAG,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACxD,IAAMrD,WAAW,GAAGoD,cAAc,CAACE,GAAG,CAACJ,IAAI,CAAC,IAAI5B,MAAI,CAACjD,oBAAoB,CAAC,CAAC,CAAC;QAC5EiD,MAAI,CAACxB,2BAA2B,CAAC,OAAO,EAAEE,WAAW,CAAC;MACvD,CAAC;IACF,CAAC,CAAC,OAAOH,CAAC,EAAE;MACXiB,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAElB,CAAC,CAAC;MACxC,IAAI,CAACwC,mBAAmB,CAAC,YAAY,CAAC;MACtC,IAAI,CAACvC,2BAA2B,CAAC,YAAY,EAAE,IAAI,CAACzB,oBAAoB,CAAC,CAAC,CAAC,CAAC;IAC7E;EACD,CAAC;EACD;AACD;AACA;AACA;AACA;AACA;EACC6C,oBAAoB,WAApBA,oBAAoBA,CAAA,EAAG;IAAA,IAAAqC,MAAA;IACtB,IAAI;MACH,IAAMhC,WAAW,GAAGlE,CAAC,CAAC,eAAe,CAAC,CAACsB,GAAG,CAAC,CAAC;MAC5C,IAAI,CAAC4C,WAAW,EAAE;MAElB,IAAI,IAAI,CAACvD,cAAc,KAAK,IAAI,CAACA,cAAc,CAACwD,UAAU,KAAKC,SAAS,CAACC,IAAI,IAAI,IAAI,CAAC1D,cAAc,CAACwD,UAAU,KAAKC,SAAS,CAACE,UAAU,CAAC,EAAE;QAC1I;MACD;MACA,IAAI,CAAC1D,8BAA8B,GAAG,CAAC;MAEvC,IAAM2D,OAAO,GAAGxB,MAAM,CAACC,QAAQ,CAACwB,QAAQ,KAAK,QAAQ,GAAG,KAAK,GAAG,IAAI;MACpE,IAAMC,MAAM,GAAG1B,MAAM,CAACC,QAAQ,CAAC0B,IAAI;MACnC,IAAMC,UAAU,GAAGC,kBAAkB,CAACV,WAAW,CAAC;MAClD,IAAMW,KAAK,MAAAC,MAAA,CAAMP,OAAO,SAAAO,MAAA,CAAML,MAAM,8EAAAK,MAAA,CAA2EH,UAAU,CAAE;MAE3H,IAAI,CAAChE,cAAc,GAAG,IAAIyD,SAAS,CAACS,KAAK,CAAC;MAC1C,IAAI,CAAClE,cAAc,CAACoE,MAAM,GAAG,YAAM;QAClCtB,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;QACxCwC,MAAI,CAACC,oBAAoB,CAAC,WAAW,CAAC;;QAEtC;QACA,IAAI;UACH,IAAM5E,KAAK,GAAG0D,MAAM,CAACf,WAAW,CAAC,CAAC1C,KAAK,CAAC,GAAG,CAAC;UAC5C,IAAID,KAAK,CAACJ,MAAM,IAAI,CAAC,EAAE;YACtB,IAAMO,UAAU,GAAGH,KAAK,CAAC,CAAC,CAAC,CAACI,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;YACjE,IAAMC,IAAI,GAAGC,IAAI,CAACH,UAAU,CAACI,MAAM,CAACJ,UAAU,CAACP,MAAM,GAAG,CAAC,CAAC,GAAIO,UAAU,CAACP,MAAM,GAAG,CAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;YAChG,IAAMY,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;YAChC,IAAMM,GAAG,GAAGC,MAAM,CAAC,CAAAJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,GAAG,KAAI,CAAC,CAAC;YACrC,IAAIA,GAAG,EAAE;cACR,IAAME,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACH,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;cACzC,IAAM8C,gBAAgB,GAAG7C,IAAI,CAAC8C,GAAG,CAAC,CAAC,EAAEjD,GAAG,GAAGE,GAAG,GAAG,EAAE,CAAC;cACpD,IAAI8D,MAAI,CAACpF,wBAAwB,EAAE+B,YAAY,CAACqD,MAAI,CAACpF,wBAAwB,CAAC;cAC9EoF,MAAI,CAACpF,wBAAwB,GAAGgC,UAAU,CAAC,YAAM;gBAChDoD,MAAI,CAACvC,8BAA8B,CAAC,gBAAgB,EAAE,IAAI,CAAC;cAC5D,CAAC,EAAEuB,gBAAgB,GAAG,IAAI,CAAC;YAC5B;UACD;QACD,CAAC,CAAC,OAAO1C,CAAC,EAAE;UACX;QAAA;MAEF,CAAC;MACD,IAAI,CAAC7B,cAAc,CAACyE,SAAS,GAAG,UAACC,KAAK,EAAK;QAC1C,IAAMC,GAAG,GAAGD,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEE,IAAI;QACvB9B,OAAO,CAACC,GAAG,CAAC4B,GAAG,CAAC;QAChB,IAAIE,IAAI,GAAG,EAAE;QACb,IAAI;UACH,IAAMC,MAAM,GAAGzD,IAAI,CAACC,KAAK,CAACgD,MAAM,CAACK,GAAG,CAAC,CAAC;UACtCE,IAAI,GAAGxD,IAAI,CAAC0D,SAAS,CAACD,MAAM,CAAC;QAC9B,CAAC,CAAC,OAAOjD,CAAC,EAAE;UACXgD,IAAI,GAAGP,MAAM,CAACK,GAAG,aAAHA,GAAG,cAAHA,GAAG,GAAI,EAAE,CAAC;QACzB;QACAY,MAAI,CAACC,oBAAoB,CAACX,IAAI,CAAC;MAChC,CAAC;MACD,IAAI,CAAC7E,cAAc,CAACgF,OAAO,GAAG,UAACN,KAAK,EAAK;QACxC5B,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAE2B,KAAK,CAAC;QAC3Ca,MAAI,CAACC,oBAAoB,CAAC,OAAO,CAAC;MACnC,CAAC;MACD,IAAI,CAACxF,cAAc,CAACiF,OAAO,GAAG,UAACP,KAAK,EAAK;QACxC,IAAMQ,IAAI,GAAGR,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEQ,IAAI;QACxB,IAAMC,MAAM,GAAGT,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAES,MAAM;QAC5BrC,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAE;UAAEmC,IAAI,EAAJA,IAAI;UAAEC,MAAM,EAANA;QAAO,CAAC,CAAC;QACvDI,MAAI,CAACC,oBAAoB,gBAAArB,MAAA,CAAgBe,IAAI,aAAJA,IAAI,cAAJA,IAAI,GAAI,EAAE,cAAAf,MAAA,CAAWgB,MAAM,aAANA,MAAM,cAANA,MAAM,GAAI,EAAE,CAAE,CAAC;QAE7E,IAAII,MAAI,CAACpF,wBAAwB,EAAE;UAClC+B,YAAY,CAACqD,MAAI,CAACpF,wBAAwB,CAAC;UAC3CoF,MAAI,CAACpF,wBAAwB,GAAG,IAAI;QACrC;QAEA,IAAMiF,cAAc,GAAG,IAAIC,GAAG,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACxD,IAAMrD,WAAW,GAAGoD,cAAc,CAACE,GAAG,CAACJ,IAAI,CAAC,IAAIK,MAAI,CAAClF,oBAAoB,CAAC,CAAC,CAAC;QAC5EkF,MAAI,CAACvC,8BAA8B,CAAC,OAAO,EAAEhB,WAAW,CAAC;MAC1D,CAAC;IACF,CAAC,CAAC,OAAOH,CAAC,EAAE;MACXiB,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAElB,CAAC,CAAC;MAC5C,IAAI,CAAC2D,oBAAoB,CAAC,YAAY,CAAC;MACvC,IAAI,CAACxC,8BAA8B,CAAC,YAAY,EAAE,IAAI,CAAC3C,oBAAoB,CAAC,CAAC,CAAC,CAAC;IAChF;EACD,CAAC;EACD;AACD;AACA;AACA;AACA;EACCgE,mBAAmB,WAAnBA,mBAAmBA,CAACoB,OAAO,EAAE;IAC5B,IAAI;MACH,IAAMC,EAAE,GAAG,IAAI9D,IAAI,CAAC,CAAC,CAAC+D,WAAW,CAAC,CAAC;MACnC,IAAMd,IAAI,OAAAV,MAAA,CAAOuB,EAAE,QAAAvB,MAAA,CAAKG,MAAM,CAACmB,OAAO,aAAPA,OAAO,cAAPA,OAAO,GAAI,EAAE,CAAC,CAAE;MAC/C,IAAI,CAACG,KAAK,CAACC,OAAO,CAAC,IAAI,CAAC9F,cAAc,CAAC,EAAE,IAAI,CAACA,cAAc,GAAG,EAAE;MACjE,IAAI,CAACA,cAAc,CAAC+F,IAAI,CAACjB,IAAI,CAAC;MAC9B,IAAI,IAAI,CAAC9E,cAAc,CAACS,MAAM,GAAG,EAAE,EAAE;QACpC,IAAI,CAACT,cAAc,GAAG,IAAI,CAACA,cAAc,CAACgG,KAAK,CAAC,CAAC,EAAE,CAAC;MACrD;MACA,IAAMC,GAAG,GAAG3G,CAAC,CAAC,kBAAkB,CAAC;MACjC,IAAI2G,GAAG,IAAIA,GAAG,CAACxF,MAAM,EAAE;QACtBwF,GAAG,CAACrF,GAAG,CAAC,IAAI,CAACZ,cAAc,CAACkG,IAAI,CAAC,IAAI,CAAC,CAAC;QACvC;QACA,IAAMC,EAAE,GAAGF,GAAG,CAACG,GAAG,CAAC,CAAC,CAAC;QACrB,IAAID,EAAE,EAAEA,EAAE,CAACE,SAAS,GAAGF,EAAE,CAACG,YAAY;MACvC;IACD,CAAC,CAAC,OAAOxE,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;AACA;AACA;EACC2D,oBAAoB,WAApBA,oBAAoBA,CAACC,OAAO,EAAE;IAC7B,IAAI;MACH,IAAMZ,IAAI,GAAGP,MAAM,CAACmB,OAAO,aAAPA,OAAO,cAAPA,OAAO,GAAI,EAAE,CAAC;MAClC,IAAMO,GAAG,GAAG3G,CAAC,CAAC,uBAAuB,CAAC;MACtC,IAAI2G,GAAG,IAAIA,GAAG,CAACxF,MAAM,EAAE;QACtBwF,GAAG,CAACrF,GAAG,CAACkE,IAAI,CAAC;QACb,IAAMqB,EAAE,GAAGF,GAAG,CAACG,GAAG,CAAC,CAAC,CAAC;QACrB,IAAID,EAAE,EAAEA,EAAE,CAACE,SAAS,GAAGF,EAAE,CAACG,YAAY;MACvC;IACD,CAAC,CAAC,OAAOxE,CAAC,EAAE;MACX;IAAA;EAEF,CAAC;EACD;AACD;AACA;EACCyE,UAAU,WAAVA,UAAUA,CAAA,EAAG;IACZ;IACAlE,MAAM,CAACnD,SAAS,CAAC,CAACK,WAAW,CAACiH,QAAQ,CAAC,CAAC;IACxCnE,MAAM,CAACnD,SAAS,CAAC,CAACM,UAAU,CAACiH,QAAQ,CAAC,CAAC;IACvCpE,MAAM,CAACnD,SAAS,CAAC,CAACwH,cAAc,CAAC,CAAC;IAClCpH,CAAC,CAAC,aAAa,CAAC,CAACqH,GAAG,CAAC,CAAC;IACtB;IACAtE,MAAM,CAACnD,SAAS,CAAC,CAAC4D,iBAAiB,CAAC,CAAC;IACrCT,MAAM,CAACnD,SAAS,CAAC,CAACiE,oBAAoB,CAAC,CAAC;EACzC,CAAC;EAED;AACD;AACA;EACCyD,iBAAiB,WAAjBA,iBAAiBA,CAAA,EAAG;IACnB,IAAIvE,MAAM,CAACnD,SAAS,CAAC,CAACQ,aAAa,CAAC8G,QAAQ,CAAC,YAAY,CAAC,EAAE;MAC3DnE,MAAM,CAACnD,SAAS,CAAC,CAACO,iBAAiB,CAACoH,WAAW,CAAC,UAAU,CAAC;MAC3DxE,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACmH,IAAI,CAAC,CAAC;IACvC,CAAC,MAAM;MACNzE,MAAM,CAACnD,SAAS,CAAC,CAACO,iBAAiB,CAACsH,QAAQ,CAAC,UAAU,CAAC;MACxD1E,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACqH,IAAI,CAAC,CAAC;IACvC;EACD,CAAC;EACD;AACD;AACA;AACA;AACA;EACCC,gBAAgB,WAAhBA,gBAAgBA,CAACC,QAAQ,EAAE;IAC1B,IAAMC,MAAM,GAAGD,QAAQ;IACvBC,MAAM,CAACtC,IAAI,GAAGxC,MAAM,CAACnD,SAAS,CAAC,CAACG,QAAQ,CAAC+H,IAAI,CAAC,YAAY,CAAC;IAC3D,OAAOD,MAAM;EACd,CAAC;EACD;AACD;AACA;EACCE,eAAe,WAAfA,eAAeA,CAAA,EAAG,CAClB,CAAC;EACD;AACD;AACA;EACCX,cAAc,WAAdA,cAAcA,CAAA,EAAG;IAChBY,IAAI,CAACjI,QAAQ,GAAGgD,MAAM,CAACnD,SAAS,CAAC,CAACG,QAAQ;IAC1CiI,IAAI,CAACC,GAAG,MAAAnD,MAAA,CAAMoD,aAAa,EAAApD,MAAA,CAAGpF,KAAK,UAAO;IAC1CsI,IAAI,CAACjH,aAAa,GAAGgC,MAAM,CAACnD,SAAS,CAAC,CAACmB,aAAa;IACpDiH,IAAI,CAACL,gBAAgB,GAAG5E,MAAM,CAACnD,SAAS,CAAC,CAAC+H,gBAAgB;IAC1DK,IAAI,CAACD,eAAe,GAAGhF,MAAM,CAACnD,SAAS,CAAC,CAACmI,eAAe;IACxDC,IAAI,CAACf,UAAU,CAAC,CAAC;EAClB,CAAC;EACD;AACD;AACA;AACA;EACCkB,YAAY,WAAZA,YAAYA,CAACC,MAAM,EAAE;IACpB,QAAQA,MAAM;MACb,KAAK,WAAW;QACfrF,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAC7BkH,WAAW,CAAC,MAAM,CAAC,CACnBA,WAAW,CAAC,KAAK,CAAC,CAClBE,QAAQ,CAAC,OAAO,CAAC;QACnB1E,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACgI,IAAI,CAACC,eAAe,CAACC,iBAAiB,CAAC;QACvE;MACD,KAAK,cAAc;QAClBxF,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAC7BkH,WAAW,CAAC,OAAO,CAAC,CACpBA,WAAW,CAAC,KAAK,CAAC,CAClBE,QAAQ,CAAC,MAAM,CAAC;QAClB1E,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACgI,IAAI,CAACC,eAAe,CAACE,oBAAoB,CAAC;QAC1E;MACD,KAAK,UAAU;QACdzF,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAC7BkH,WAAW,CAAC,OAAO,CAAC,CACpBA,WAAW,CAAC,KAAK,CAAC,CAClBE,QAAQ,CAAC,MAAM,CAAC;QAClB1E,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACgI,IAAI,0CAAAvD,MAAA,CAAwCwD,eAAe,CAACG,oBAAoB,CAAE,CAAC;QACnH;MACD;QACC1F,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAC7BkH,WAAW,CAAC,OAAO,CAAC,CACpBA,WAAW,CAAC,KAAK,CAAC,CAClBE,QAAQ,CAAC,MAAM,CAAC;QAClB1E,MAAM,CAACnD,SAAS,CAAC,CAACS,aAAa,CAACgI,IAAI,CAACC,eAAe,CAACE,oBAAoB,CAAC;QAC1E;IACF;EACD;AACD,CAAC;AAEDxI,CAAC,CAAC0I,QAAQ,CAAC,CAACC,KAAK,CAAC,YAAM;EACvB;EACA5F,MAAM,CAACnD,SAAS,CAAC,GAAGE,sBAAsB;EAC1CiD,MAAM,CAACnD,SAAS,CAAC,CAACqH,UAAU,CAAC,CAAC;AAC/B,CAAC,CAAC","ignoreList":[]}